---
title: "로컬 스코프"
description: "간단한 예제 문제로 알아보는 로컬 스코프"
date: 2024-09-27 00:22:13
series: "Javascript"
image: ""
tags:
  - 자바스크립트
---

스터디 멤버 중 한 분이 면접에서 받았다는 질문을 보고 문득 내가 저 질문을 받았을 때 어떻게 답하는게 좋을지 곰곰히 생각해 보다가 포스팅을 하기로 마음먹었다.

## 어떤 문자열이 출력될까?

```js
const animal = "cat";

const myFunction = () => {
  const animal = "dog";

  console.log(animal);
};

myFunction();
```

> Q: 이런 코드가 있다고 했을 때, 콘솔에는 어떤 값이 찍히는가?

_코드의 변수명과 문자열 등은 보기 쉽게 약간 변형하였다._
사실 문제를 보자 마자 `dog`가 출력될 것이라고 바로 알아챘을 것이다. 하지만 이걸 말로 어떻게 풀어내느냐가 관건이다. 여기서 가장 중요한 키워드는 무엇일까? 바로 이 글의 제목인 **로컬 스코프**일 것이다.

### 로컬 스코프

함수가 실행되어 콘솔이 `dog`를 출력하기까지의 과정을 살펴보면 이렇다.

1. `myFunction` 함수가 실행되어 내부의 `console.log()`가 동작한다.
2. `console.log()`의 인자로 전달된 `animal`을 찾기 위해 함수의 로컬 스코프 내에서 `animal`을 찾는다.
3. 찾은 `animal`을 출력한다.

즉, 변수를 찾을 때 유효 범위인 로컬 스코프에서 탐색을 시작하게 된다. 그럼 만약 로컬 스코프의 `animal` 변수를 주석 처리하면 어떻게 될까?

```js
const animal = "cat";

const myFunction = () => {
  // const animal = "dog";

  console.log(animal);
};

myFunction();
```

당연히 `cat`이 출력 될 것이다. 그럼 이 과정을 따라가 보자.

1. `myFunction` 함수가 실행되어 내부의 `console.log()`가 동작한다.
2. `console.log()`의 인자로 전달된 `animal`을 찾기 위해 함수의 로컬 스코프 내에서 `animal`을 찾는다.
3. 찾지 못하였다면 찾을 때 까지 계속해서 **상위 스코프**로 올라가 `animal`을 찾는다.
4. `animal`을 찾으면 출력하고 전역 스코프에서도 찾지 못하면 `ReferenceError`를 표시한다.

### 스코프 체이닝과 렉시컬 환경

이렇게 변수를 호출하는 함수를 사용하게 되면 먼저 자신의 유효 범위에서 검색하고, 변수가 존재하지 않으면 차례대로 상위 스코프에서 변수를 검색하는 과정을 **스코프 체이닝** 이라고 한다.

이는 **렉시컬 환경**이라는 용어로 설명을 할 수 있다.
블록 단위의 실행 컨텍스트가 생성이 되면 블록의 내부 정보인 **환경 레코드**와 외부 정보인 **외부 환경 참조**가 실행 컨텍스트에 담기게 된다.
함수가 변수를 호출하면 먼저 **환경 레코드**를 검색하여 변수를 찾게 되고, 발견하지 못하면 **상위 스코프의 환경 레코드**에서 변수를 검색하게 되며 외부 환경이 없는 최상위 스코프인 **전역 실행 컨텍스트**에서도 변수를 찾지 못하면 에러를 발생시킨다.

## 결론

정말 간단한 예제이지만 면접관의 의도는 단순히 정답을 말하는 것이 아니라 자바스크립트에서 로컬 스코프와 스코프 체이닝을 이해하고 있느냐를 관통하는 것이 아닐까 싶다. 물론 실제 이 면접 질문을 받은 분도 잘 하시니 대답도 깔끔하게 하셨으리라 생각한다.
